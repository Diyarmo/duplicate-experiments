schema: '2.0'
stages:
  train_siamese_simple_transformer_general_queue:
    cmd: "python ../../src/train.py params.yaml siamese_simple_transformer ../../storage/data/prepared/general_train.parquet\
      \ ../../storage/data/prepared/general_val.parquet ../../storage/models/tokenizers/tokenizer_general.json\
      \ ../../storage/models/categorical_encodings/general_categories_encoding.npy\
      \ ../../storage/models/categorical_encodings/general_cities_encoding.npy\n"
    deps:
    - path: ../../src/modeling/siamese_simple_transformer/data.py
      md5: 4a273627db86b97454004ffb1eb445d2
      size: 6549
    - path: ../../src/modeling/siamese_simple_transformer/model.py
      md5: 1a482592eabfc9e5392dff03ff295a43
      size: 9857
    - path: ../../src/train.py
      md5: 3f819a33b7a1d83cc1a8b02b55514401
      size: 3358
    - path: ../../storage/data/prepared/general_train.parquet
      md5: f7298805fe8fe3c80b7e2fc9fbe8f12f
      size: 1434369755
    - path: ../../storage/data/prepared/general_val.parquet
      md5: 69f86c56689eaa9d5d83fe3c95470ec3
      size: 3194175235
    - path: ../../storage/models/categorical_encodings/general_categories_encoding.npy
      md5: 55be1adf9d6238d9fd20ee485201e6e4
      size: 4882
    - path: ../../storage/models/categorical_encodings/general_cities_encoding.npy
      md5: 73df39d8131fcef1cb2b8c1fcafd78c2
      size: 4537
    - path: ../../storage/models/tokenizers/tokenizer_general.json
      md5: 69a183a40824b3d2d38f6cfc3559ca4e
      size: 1342740
    params:
      params.yaml:
        siamese_simple_transformer.initial_lr: 0.0003
        siamese_simple_transformer.max_epochs: 10
        siamese_simple_transformer.num_heads: 4
        siamese_simple_transformer.output_feature_dim: 256
        siamese_simple_transformer.text_embed_dim: 128
        siamese_simple_transformer.text_hidden_dim: 256
        siamese_simple_transformer.text_max_length: 512
        siamese_simple_transformer.text_num_layers: 2
    outs:
    - path: ../../storage/models/siamese_simple_transformer_general_model.ckpt
      md5: 84fa741a5600100b961ea1de4745c7e8
      size: 93821745
  train_siamese_simple_distil_bert_general_queue:
    cmd: "python ../../src/train.py params.yaml siamese_simple_distil_bert ../../storage/data/prepared/general_train.parquet\
      \ ../../storage/data/prepared/general_val.parquet ../../storage/models/categorical_encodings/general_categories_encoding.npy\
      \ ../../storage/models/categorical_encodings/general_cities_encoding.npy   \
      \   \n"
    deps:
    - path: ../../src/modeling/siamese_simple_distil_bert/data.py
      md5: 4e2e1f5c5880f0c3039a4536072bfe00
      size: 6550
    - path: ../../src/modeling/siamese_simple_distil_bert/model.py
      md5: 2cfdf2782c8d0c21ca4e2c1c9fc190c8
      size: 8257
    - path: ../../src/train.py
      md5: 8c2c06d4bff0b5236f33c11283dd6913
      size: 2343
    - path: ../../storage/data/prepared/general_train.parquet
      md5: f7298805fe8fe3c80b7e2fc9fbe8f12f
      size: 1434369755
    - path: ../../storage/data/prepared/general_val.parquet
      md5: 69f86c56689eaa9d5d83fe3c95470ec3
      size: 3194175235
    - path: ../../storage/models/categorical_encodings/general_categories_encoding.npy
      md5: 55be1adf9d6238d9fd20ee485201e6e4
      size: 4882
    - path: ../../storage/models/categorical_encodings/general_cities_encoding.npy
      md5: 73df39d8131fcef1cb2b8c1fcafd78c2
      size: 4537
    params:
      params.yaml:
        siamese_simple_distil_bert.features_emb_dim: 20
        siamese_simple_distil_bert.initial_lr: 0.001
        siamese_simple_distil_bert.max_epochs: 3
        siamese_simple_distil_bert.output_feature_dim: 296
        siamese_simple_distil_bert.text_max_length: 512
    outs:
    - path: ../../storage/models/siamese_simple_distil_bert_general_model.ckpt
      md5: e35edd6eab1afbbb5f4ad3fe3d3042c2
      size: 321126621
  evaluate_siamese_simple_distil_bert_general_queue:
    cmd: "python ../../src/evaluate.py siamese_simple_distil_bert ../../storage/data/prepared/general_val.parquet\
      \ ../../storage/models/categorical_encodings/general_categories_encoding.npy\
      \ ../../storage/models/categorical_encodings/general_cities_encoding.npy   \
      \      ../../storage/models/siamese_simple_distil_bert_general_model.ckpt\n"
    deps:
    - path: ../../src/evaluate.py
      md5: 767e3c681711629de747e5dc4422f335
      size: 4027
    - path: ../../src/modeling/siamese_simple_distil_bert/evaluate.py
      md5: fe1b9dd2ce5c1f9ad13d028793a75cd5
      size: 1167
    - path: ../../storage/data/prepared/general_val.parquet
      md5: 69f86c56689eaa9d5d83fe3c95470ec3
      size: 3194175235
    - path: ../../storage/models/categorical_encodings/general_categories_encoding.npy
      md5: 55be1adf9d6238d9fd20ee485201e6e4
      size: 4882
    - path: ../../storage/models/categorical_encodings/general_cities_encoding.npy
      md5: 73df39d8131fcef1cb2b8c1fcafd78c2
      size: 4537
    - path: ../../storage/models/siamese_simple_distil_bert_general_model.ckpt
      md5: e35edd6eab1afbbb5f4ad3fe3d3042c2
      size: 321126621
    outs:
    - path: ../../logs/siamese_simple_distil_bert_general_scores_file.json
      md5: fabe7228698393b77a75d10005ddd2e8
      size: 26
    - path: ../../storage/data/prepared/siamese_simple_distil_bert_general_val_with_preds.parquet
      md5: eafae6324610f3fce8da37ab35e692ee
      size: 228668105
  update_readme:
    cmd: "python ../../src/update_readme.py params.yaml ../basic/params.yaml siamese_simple_distil_bert\
      \ ../../logs/siamese_simple_distil_bert_general_scores_file.json\n"
    deps:
    - path: ../../logs/siamese_simple_distil_bert_general_scores_file.json
      md5: fabe7228698393b77a75d10005ddd2e8
      size: 26
    - path: ../../src/update_readme.py
      md5: 9931629472c9978ed5116d481997e900
      size: 1381
    - path: ../../storage/data/prepared/siamese_simple_distil_bert_general_val_with_preds.parquet
      md5: eafae6324610f3fce8da37ab35e692ee
      size: 228668105
